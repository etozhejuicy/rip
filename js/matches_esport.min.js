var coreEsportMatch={};function betsPopup(t){Core.Ajax.get("/esport/match/bets/".concat(t,"/"),function(t){Core.Popup.create("Ставки",t.data.popup)})}$(document).ready(function(){var t=null,e="",a="";$(".p-content").hasClass("esport-content-match")&&(a="match"),$(".p-content").hasClass("esport-content-map")&&(a="map"),coreEsportMatch.searchHide=function(){clearTimeout(t),$(".esport-search-results").stop().animate({top:"45px",opacity:0},200,function(){$(".esport-search-results").hide()}),$(".esport-match-wrapper, .esport-map-wrapper").stop().animate({opacity:1},200),e=""},coreEsportMatch.searchShow=function(){$(".esport-search-results").show().stop().animate({top:"38px",opacity:1},200),$(".esport-match-wrapper, .esport-map-wrapper").stop().animate({opacity:.2},200)},coreEsportMatch.getMatchListByFilters=function(){var t=$(".active-filters").find('[data-type="team"]').attr("data-value"),e=$(".active-filters").find('[data-type="tournament"]').attr("data-value"),s=$(".active-filters").find('[data-type="date"]').attr("data-value"),i={};null!=t&&(i.team=t),null!=e&&(i.tournament=e),null!=s&&(i.date=s);var r=$.param(i);switch(""!=r&&(r="?"+r),a){case"match":$.ajax({url:base_url+"esport/match/getListByFilters"+r,type:"get",success:function(t){$(".esport-match").html(t.matches),coreEsportMatch.setEventOnShowingFullFutureMatches(),coreEsportMatch.setEventOnShowingResult(),coreUtils.setEventOnTitleTooltipes(),history.pushState("","","/esport/matches/"+r)}});break;case"map":$.ajax({url:base_url+"esport/map/getListByFilters"+r,type:"get",success:function(t){$(".esport-map").html(t.matches),coreEsportMatch.setEventOnShowingResult(),coreUtils.setEventOnTitleTooltipes(),history.pushState("","","/esport/maps/"+r)}})}},coreEsportMatch.loadBlockShow=function(){$(".esport-search-results").find(".esport-no-results-load-block").stop().fadeIn(0)},coreEsportMatch.loadBlockHide=function(){$(".esport-search-results").find(".esport-no-results-load-block").stop().fadeOut(200)},coreEsportMatch.setEventOnShowingResult=function(){switch($(".match-shop-result").off("click").on("click",function(){var t=$(this);return t.text(t.data("value")),!1}),a){case"map":$(".esport-match-show-vod").off("click").on("click",function(){var t=$(this).data("id"),e=$(this).data("game-number");popup_show('<div class="popup-overlay"><div class="popup"><div class="close"><i class="fa fa-times"></i></div><div class="offer-popup-form"><h2>Игра '+e+'</h2><div style="width:860px; height: 484px;"><iframe width="100%" height="100%" src="https://www.youtube.com/embed/'+t+'" frameborder="0" allowfullscreen="" scrolling="no"></iframe></div></div></div></div>')}),$(".esport-match-show-result").off("click").on("click",function(){var t=$(this);$.ajax({url:base_url+"esport/match/ajaxGetMapResult/"+t.data("id"),type:"get",success:function(t){popup_show(t)}})})}},$(document).on("click",".esport-match-view-map-single-reload-button",function(){var t=$(this).data("match"),e=$(this).data("tab");$.ajax({url:base_url+"esport/match/ajaxGetMatchData/"+t,type:"get",success:function(t){$(".esport-match-current-pick-wrapper .esport-tabs-wrapper").html(t.view),$('.esport-tabs-single[data-tab="'+e+'"]').click()}})});var s="";function i(){$(".active-filters").find(".active-filters-single").off("click").on("click",function(){$(this).remove(),"date"==$(this).attr("data-type")&&$("#datepicker").val(""),coreEsportMatch.getMatchListByFilters()})}coreEsportMatch.setEventOnShowingFullFutureMatches=function(){$(".esport-match-future-matches-show").off("click").on("click",function(){if(""==s){s=$(this).text(),$(this).text($(this).data("toggle-title"));var t=$(".active-filters").find('[data-type="team"]').attr("data-value"),e=$(".active-filters").find('[data-type="tournament"]').attr("data-value"),a=$(".active-filters").find('[data-type="date"]').attr("data-value"),i={};null!=t&&(i.team=t),null!=e&&(i.tournament=e),null!=a&&(i.date=a);var r=$.param(i);""!=r&&(r="?"+r),$.ajax({url:"/esport/match/getFullFutureList/"+r,type:"get",success:function(t){$(".esport-match-future-list").html(t.matches),coreEsportMatch.setEventOnShowingResult()}})}else $(this).text(s),s="",$(".esport-match-future-list").find(".esport-match-single").slice(10).fadeOut(200);return!1})},coreEsportMatch.setEventOnShowingResult(),coreEsportMatch.setEventOnShowingFullFutureMatches(),i(),$(".esport-match-index-search").find("input").keyup(function(){clearTimeout(t);var a=$(this).val();coreEsportMatch.searchShow(),""!=a?a!=e?(coreEsportMatch.loadBlockShow(),t=setTimeout(function(){e=a,$.ajax({url:base_url+"esport/match/getListForSearch?value="+a,type:"get",success:function(t){coreEsportMatch.loadBlockHide(),$(".esport-search-results-content").html(t.view),$(".esport-search-results-teams").find(".single").off("click").on("click",function(){if("active-filters-single"!=$(".active-filters").find('[data-type="team"]').attr("class")){var t=$(".filters-clone").find('[data-type="team"]').clone();t.find("span").text($(this).find("span").text()),t.attr("data-value",$(this).attr("data-id")),$(".active-filters").append(t)}else $(".active-filters").find('[data-type="team"]').find("span").text($(this).find("span").text()),$(".active-filters").find('[data-type="team"]').attr("data-value",$(this).attr("data-id"));coreEsportMatch.getMatchListByFilters(),i()}),$(".esport-search-results-tournaments").find(".single").off("click").on("click",function(){if("active-filters-single"!=$(".active-filters").find('[data-type="tournament"]').attr("class")){var t=$(".filters-clone").find('[data-type="tournament"]').clone();t.find("span").text($(this).find("span").text()),t.attr("data-value",$(this).attr("data-id")),$(".active-filters").append(t)}else $(".active-filters").find('[data-type="tournament"]').find("span").text($(this).find("span").text()),$(".active-filters").find('[data-type="tournament"]').attr("data-value",$(this).attr("data-id"));coreEsportMatch.getMatchListByFilters(),i()})}})},500)):coreEsportMatch.loadBlockHide():coreEsportMatch.searchHide()}).blur(function(){coreEsportMatch.searchHide()}).focus(function(){""!=$(this).val()&&coreEsportMatch.searchShow()}),$("#datepicker").on("change",function(){if(""==$(this).val())return $(".active-filters").find('[data-type="date"]').remove(),!1;if("active-filters-single"!=$(".active-filters").find('[data-type="date"]').attr("class")){var t=$(".filters-clone").find('[data-type="date"]').clone();t.find("span").text($(this).val()),t.attr("data-value",$(this).val()),$(".active-filters").append(t)}else $(".active-filters").find('[data-type="date"]').find("span").text($(this).val()),$(".active-filters").find('[data-type="date"]').attr("data-value",$(this).val());coreEsportMatch.getMatchListByFilters(),i()}),$(document).on("click",".esport-tabs-single",function(){var t=$(this),e=t.parents(".esport-tabs-wrapper"),a=t.data("tab");e.find(".esport-tabs").find(".active").removeClass("active"),t.addClass("active"),e.find(".esport-tabs-content").hide(),e.find('.esport-tabs-content[data-tab="'+a+'"]').show()}),$(".esport-match-show-vods-list").click(function(){var t=$(this).data("id"),e=$(this).data("game-number"),a="",s="";for(var i in t){var r=t[i];0==i&&(s='<div style="width:860px; height: 484px;"><iframe class="currentVod" width="100%" height="100%" src="https://www.youtube.com/embed/'+r.link+'" frameborder="0" allowfullscreen="" scrolling="no"></iframe></div>'),a+='<div class="esport-tabs-single esport-match-vods-list-item'+(0==i?" active":"")+'"data-id="'+r.link+'"data-game-number="'+e+'"title="Смотреть запись"><span>'+r.name+"</span></div>"}popup_show('<div class="popup-overlay"><div class="popup"><div class="close"><i class="fa fa-times"></i></div><div class="offer-popup-form"><h2>Игра '+e+'</h2><div class="esport-tabs clearfix">'+a+"</div>"+s+"</div></div></div></div>")}),$(document).on("click",".esport-match-vods-list-item",function(){var t=$(this).data("id");$(".esport-match-vods-list-item").removeClass("active"),$(this).addClass("active"),$(".currentVod").attr("src","https://www.youtube.com/embed/"+t)}),$(document).on("click",".esport-match-show-vod",function(){var t=$(this).data("id"),e=$(this).data("game-number");popup_hide(),popup_show('<div class="popup-overlay"><div class="popup"><div class="close"><i class="fa fa-times"></i></div><div class="offer-popup-form"><h2>Игра '+e+'</h2><div style="width:860px; height: 484px;"><iframe width="100%" height="100%" src="https://www.youtube.com/embed/'+t+'" frameborder="0" allowfullscreen="" scrolling="no"></iframe></div></div></div></div>')}),$(".esport-match-show-winner").click(function(){var t=$(this).data("winner-id");if(null==t)return!1;$(this).parents(".esport-match-view-vods-single").find('.esport-match-view-vods-single-pick[data-team-id!="'+t+'"]').animate({opacity:.2},200)}),$(".match-view-stream-tabs-single").click(function(){var t=$(this).data("tab");$(".match-view-stream-tabs-single").removeClass("active"),$(this).addClass("active"),$(".esport-match-view-stream").hide(),$('.esport-match-view-stream[data-stream-tab="'+t+'"]').show()}),$(document).on("click",".esport-match-view-info-basic-poll-link",function(){var t=$(this),e=t.data("team-id"),a=t.data("match-id");return $.ajax({url:"/esport/forecast/ajaxVote/"+a+"/"+e,type:"get",success:function(s){null!=s.message&&createNotice(s.message),null!=s.auth&&!1===s.auth&&$.ajax({url:base_url+"members/showModalAuth/",type:"get",data:{forecastVote:!0,matchId:a,teamId:e},success:function(t){null==t.message?popup_show(t):createNotice(t.message)}}),1==s.status&&(t.parent().append('<div class="esport-match-your-vote">Ваш голос</div>'),$(".esport-match-view-info-basic-poll-link").remove(),$(".esport-match-view-info-basic-poll-left").find("b").text(s.percentTeamLeft+"%"),$(".esport-match-view-info-basic-poll-right").find("b").text(s.percentTeamRight+"%"),$(".esport-match-view-info-basic-poll-left").find("span").text(s.votesTeamLeft),$(".esport-match-view-info-basic-poll-right").find("span").text(s.votesTeamRight),$(".esport-match-view-info-basic-poll-left").removeClass("esport-match-view-info-basic-poll-green"),$(".esport-match-view-info-basic-poll-right").removeClass("esport-match-view-info-basic-poll-green"),s.percentTeamLeft>s.percentTeamRight?($(".esport-match-view-info-basic-poll-left").addClass("esport-match-view-info-basic-poll-green"),$(".esport-match-view-info-basic-poll-line-active").css({width:s.percentTeamLeft+"%",left:0})):($(".esport-match-view-info-basic-poll-right").addClass("esport-match-view-info-basic-poll-green"),$(".esport-match-view-info-basic-poll-line-active").css({width:s.percentTeamRight+"%",right:0})))}}),!1}),setInterval(function(){$(".esport-match-duration-dynamic").each(function(){var t,e=$(this),a=new Date,s=new Date;s.setTime(1e3*e.data("value")),t=a-s;var i=Math.floor(t/36e5)%24,r=Math.floor(t/6e4)%60,o=Math.floor(t/1e3)%60;o<10&&(o="0"+o),r<10&&i>0&&(r="0"+r),i>0?e.text("+"+i+":"+r+":"+o):e.text("+"+r+":"+o)})},1e3),$(".esport-match-current-pick-tabs").find(".esport-match-current-pick-tabs-single").click(function(){var t=$(this);$(".esport-match-current-pick-tabs-single").removeClass("esport-match-current-pick-tabs-single-active"),t.addClass("esport-match-current-pick-tabs-single-active"),$(".esport-match-view-map-single").hide(),$('.esport-match-view-map-single[data-tab-id="'+t.data("tab-id")+'"]').show()}),$(document).on("click",".esport-match-show-result",function(){var t=$(this);$.ajax({url:"/esport/match/ajaxGetMapResult/"+t.data("id"),type:"get",success:function(t){popup_show(t)}})}),$(document).on("click",".esport-match-show-statistic",function(){var t=$(this);$.ajax({url:"/esport/match/ajaxGetMapStatistic/"+t.data("id"),type:"get",success:function(t){popup_show(t)}})}),$(".esport-tournament-view-grid-single-column-game-single-row").on("mouseover",function(){$('.esport-tournament-view-grid-single-column-game-single-row[data-team-id="'+$(this).data("team-id")+'"]').addClass("esport-grind-team-hover")}).on("mouseleave",function(){$('.esport-tournament-view-grid-single-column-game-single-row[data-team-id="'+$(this).data("team-id")+'"]').removeClass("esport-grind-team-hover")}),$(".esport-tournament-view-grid-single").width()<$(".esport-tournament-view-grid-single-layout").width()&&$(".esport-tournament-view-grid-single").addClass("mod-moveable");var r,o,n=!1;$(".esport-tournament-view-grid-single").on({"mousemove touchmove":function(t){n&&("touchmove"===t.type?$(".esport-tournament-view-grid-single").scrollLeft(o+(r-t.originalEvent.touches[0].pageX)):$(".esport-tournament-view-grid-single").scrollLeft(o+(r-t.pageX)))},"mousedown touchstart":function(t){n=!0,o=$(".esport-tournament-view-grid-single").scrollLeft(),r="touchstart"===t.type?t.originalEvent.touches[0].pageX:t.pageX},"mouseup touchend":function(){n=!1}}),$(".esport-match-view-stream-image i").click(function(){var t=$(this).parents(".esport-match-view-stream").find(".esport-match-view-stream-player");t.html(decodeURIComponent(escape(window.atob(t.html())))),t.show(),$(this).parents(".esport-match-view-stream-image").remove()});var c=null;$(".esport-team-search").find("input").on("keyup",function(){var t={team:$(this).val(),region:$("#region").val()};$(this);clearTimeout(c),""!=t.team||0!=t.region?c=setTimeout(function(){$.ajax({url:base_url+"esport/team/getListByFilter/",type:"post",data:t,cache:!1,success:function(t){$(".esport-team-list").hide(),$(".esort-team-pagination").hide(),$(".esport-team-list-search-list").html(t.view).show()}})},300):($(".esport-team-list").show(),$(".esort-team-pagination").show(),$(".esport-team-list-search-list").hide())}),$(".esport-team-search button").on("click",function(){$(".esport-team-search button").removeAttr("style"),$(this).css({background:"#1A5880",color:"#fff"}),$("#region").val($(this).data("region"));var t={region:$(this).data("region"),team:$(".esport-team-search").find("input").val()};""!=t.team||0!=t.region?$.ajax({url:base_url+"esport/team/getListByFilter/",type:"post",data:t,cache:!1,success:function(t){$(".esport-team-list").hide(),$(".esort-team-pagination").hide(),$(".esport-team-list-search-list").html(t.view).show()}}):($(".esport-team-list").show(),$(".esort-team-pagination").show(),$(".esport-team-list-search-list").hide())});var l=null;$(".esport-player-search").find("input").on("keyup",function(){var t=$(this);clearTimeout(l),""!=t.val()?l=setTimeout(function(){$.ajax({url:base_url+"esport/player/getListByValue/"+t.val(),type:"get",success:function(t){$(".esport-player-list").hide(),$(".esort-player-pagination").hide(),$(".esport-player-list-search-list").html(t.view).show()}})},300):($(".esport-player-list").show(),$(".esort-player-pagination").show(),$(".esport-player-list-search-list").hide())}),$(".roster-changes-region").on("change",function(){$(this).parents("form").submit()}),$('.user-edit-block[data-category="player"]').click(function(){var t=$(this);$.ajax({url:base_url+"esport/player/getFormForEdit/"+t.data("id"),type:"get",success:function(e){if(null!=e.message)return createNotice(e.message),!1;popup_show(e),function(){$(".selector-input").off("keyup").on("keyup",function(){clearTimeout(p);var t=$(this),e=t.parents(".selector"),a=e.find(".selector-list");if(empty(t.val()))return e.find(".selector-input-hidden").val(""),e.find(".selector-list").html(""),void a.hide();a.fadeIn(200);var s="";e.hasClass("selector-team")?s="yana/esport/team/getListByValue":e.hasClass("selector-tournament")?s="yana/esport/tournament/getListByValue":e.hasClass("selector-hero")?s="yana/heroes/getListByValue":e.hasClass("selector-player")&&(s="yana/esport/player/getListByValue"),""!=s&&(p=setTimeout(function(){$.ajax({url:base_url+s+"?value="+t.val(),type:"get",success:function(t){e.find(".selector-list").html(t.view),$(".selector-list").find(".single").off("click").on("click",function(){var t=$(this),e=t.parents(".selector");e.find(".selector-input-hidden").val(t.data("id")),e.hasClass("selector-test")?e.find(".selector-input").val(t.find("span").text()):e.find(".selector-input").val(t.find(".single-title").text()),$(".selector-list").html("").hide()})}})},1e3))}).off("blur").on("blur",function(){var t=$(this),e=t.parents(".selector"),a=e.find(".selector-list");setTimeout(function(){a.fadeOut(200,function(){a.html("")})},400)})}(),$(".esport-player-edit").find(".send").click(function(){var e=$(".esport-player-edit").find('input[name="player_nick"]'),a=$(".esport-player-edit").find('select[name="player_country_id"]'),s=$(".esport-player-edit").find('input[name="player_name"]'),i=$(".esport-player-edit").find('input[name="player_team_id"]'),r=$(".esport-player-edit").find('input[name="player_birthday"]');$.ajax({url:base_url+"esport/player/getFormForEdit/"+t.data("id"),type:"post",data:{nick:e.val(),country:a.val(),name:s.val(),team:i.val(),birthday:r.val()},success:function(t){popup_hide(),createNotice(t.message)}})})}})}),$('.user-edit-block[data-category="team"]').click(function(){var t=$(this);$.ajax({url:base_url+"esport/team/getFormForEdit/"+t.data("id"),type:"get",success:function(e){if(null!=e.message)return createNotice(e.message),!1;popup_show(e),$(".esport-team-edit").find(".send").click(function(){var e=$(".esport-team-edit").find('input[name="team_title"]'),a=$(".esport-team-edit").find('select[name="team_country_id"]'),s=$(".esport-team-edit").find('textarea[name="team_desc"]'),i=$(".esport-team-edit").find('input[name="team_earn"]');$.ajax({url:base_url+"esport/team/getFormForEdit/"+t.data("id"),type:"post",data:{title:e.val(),country:a.val(),desc:s.val(),earn:i.val()},success:function(t){popup_hide(),createNotice(t.message)}})})}})});var p=null;var d="";$(".esport-tournament-view-teams-wrapper-show-all").click(function(){if(""==d)d=$(this).text(),$(this).text($(this).data("toggle-title")),$(".esport-tournament-view-teams-wrapper-list-single").fadeIn(200);else{$(this).text(d),d="";$(".esport-tournament-view-teams-wrapper-list-single").slice(6).fadeOut(200)}return!1});var h="";$(".esport-tournament-view-news-list").children().slice(3).hide(),$(".esport-tournament-view-news-wrapper-show-all").click(function(){if(""==h)h=$(this).text(),$(this).text($(this).data("toggle-title")),$(".esport-tournament-view-news-list").children().fadeIn(200);else{$(this).text(h),h="";$(".esport-tournament-view-news-list").children().slice(3).fadeOut(200)}return!1});var u="";$(".video-list").children().slice(3).hide(),$(".esport-tournament-view-video-wrapper-show-all").click(function(){if(""==u)u=$(this).text(),$(this).text($(this).data("toggle-title")),$(".video-list").children().fadeIn(200);else{$(this).text(u),u="";$(".video-list").children().slice(3).fadeOut(200)}return!1});var m="";$(".esport-team-view-tournaments-wrapper h2 a").on("click",function(){return""==m?(m=$(this).text(),$(this).text($(this).data("toggle-title"))):($(this).text(m),m=""),$(this).parents("div").find(".esport-team-view-tournaments-list-single:nth-child(n7)").fadeToggle(200),!1}),$(window).width()<1251&&$(".js-esport-match-view-stream").height($(".js-esport-match-view-stream").width()/1.78)});
